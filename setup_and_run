#!/usr/bin/env bash
# Tá»± Ä‘á»™ng chuyá»ƒn Ä‘áº¿n thÆ° má»¥c chá»©a script
cd "$(dirname "$0")"

# =============================================
#   NIGHT CHECKER â€“ Setup & Run (Cross-Platform)
# =============================================

echo "============================================="
echo "        NIGHT CHECKER â€“ Setup & Run"
echo "============================================="

# Detect OS
OS_TYPE="$(uname -s)"
IS_WINDOWS=false
case "$OS_TYPE" in
    *NT*|*MINGW*|*CYGWIN*) IS_WINDOWS=true ;;
esac

# Function to create virtual environment
create_venv() {
    echo "ğŸ”§ Creating virtual environment..."
    if $IS_WINDOWS; then
        python -m venv venv
    else
        python3 -m venv venv
    fi
}

# Create venv if not exists
if [ ! -d "venv" ]; then
    create_venv
else
    echo "âœ… Virtual environment already exists."
fi

# Activate venv
echo "âš™ï¸  Activating virtual environment..."
if $IS_WINDOWS; then
    source venv/Scripts/activate
else
    source venv/bin/activate
fi

# Install dependencies
if [ -f "requirements.txt" ]; then
    echo "ğŸ“¦ Installing dependencies..."
    pip install --upgrade pip > /dev/null
    pip install -r requirements.txt
else
    echo "âš ï¸  No requirements.txt found, skipping..."
fi

# Run main script
if [ -f "main.py" ]; then
    echo "ğŸš€ Running main.py..."
    python main.py
else
    echo "âŒ main.py not found!"
fi

echo "============================================="
echo "âœ… Setup complete!"
echo "============================================="
